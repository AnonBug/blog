(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{526:function(t,s,a){t.exports=a.p+"assets/img/广播的例子.5b5724e5.png"},737:function(t,s,a){"use strict";a.r(s);var m=a(26),c=Object(m.a)({},(function(){var t=this,s=t.$createElement,m=t._self._c||s;return m("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[m("h1",{attrs:{id:"python-与向量化"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#python-与向量化"}},[t._v("#")]),t._v(" python 与向量化")]),t._v(" "),m("h2",{attrs:{id:"_1-向量化"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#_1-向量化"}},[t._v("#")]),t._v(" 1. 向量化")]),t._v(" "),m("p",[t._v("借助 "),m("code",[t._v("numpy")]),t._v(" 等库的内部函数使用向量化，实现了 "),m("code",[t._v("SIMD")]),t._v(" 并行计算，能够充分利用 "),m("code",[t._v("CPU")]),t._v(" 和 "),m("code",[t._v("GPU")]),t._v(" 的能力。")]),t._v(" "),m("h3",{attrs:{id:"cpu-与-gpu"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#cpu-与-gpu"}},[t._v("#")]),t._v(" CPU 与 GPU")]),t._v(" "),m("p",[t._v("还有一种方式也可以更加快速的计算，就是GPU，它可以实现更好的并行操作，从而加快计算速度。（以下部分简单了解即可）")]),t._v(" "),m("p",[t._v("CPU是一个有多种功能的优秀领导者。它的优点在于调度、管理、协调能力强，计算能力则位于其次。而GPU相当于一个接受CPU调度的“拥有大量计算能力”的员工。")]),t._v(" "),m("p",[t._v("当需要对大数据bigdata做同样的事情时，GPU更合适，当需要对同一数据做很多事情时，CPU正好合适。")]),t._v(" "),m("p",[t._v("GPU能做什么？关于图形方面的以及大型矩阵运算，如机器学习算法等方面，GPU就能大显身手。")]),t._v(" "),m("p",[t._v("简而言之，CPU擅长统领全局等复杂操作，GPU擅长对大数据进行简单重复操作。CPU是从事复杂脑力劳动的教援，而GPU是进行大量并行计算的体力劳动者\n。")]),t._v(" "),m("h3",{attrs:{id:"代码实现"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#代码实现"}},[t._v("#")]),t._v(" 代码实现")]),t._v(" "),m("div",{staticClass:"language-python line-numbers-mode"},[m("pre",{pre:!0,attrs:{class:"language-python"}},[m("code",[m("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" numpy "),m("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" np\n\na "),m("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rand"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),m("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000000")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nb "),m("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rand"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),m("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000000")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),m("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用向量化")]),t._v("\nc "),m("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dot"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),m("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用 for 循环")]),t._v("\nc "),m("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),m("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),m("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),m("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),m("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),m("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000000")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  c "),m("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" a"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),m("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" b"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),m("div",{staticClass:"line-numbers-wrapper"},[m("span",{staticClass:"line-number"},[t._v("1")]),m("br"),m("span",{staticClass:"line-number"},[t._v("2")]),m("br"),m("span",{staticClass:"line-number"},[t._v("3")]),m("br"),m("span",{staticClass:"line-number"},[t._v("4")]),m("br"),m("span",{staticClass:"line-number"},[t._v("5")]),m("br"),m("span",{staticClass:"line-number"},[t._v("6")]),m("br"),m("span",{staticClass:"line-number"},[t._v("7")]),m("br"),m("span",{staticClass:"line-number"},[t._v("8")]),m("br"),m("span",{staticClass:"line-number"},[t._v("9")]),m("br"),m("span",{staticClass:"line-number"},[t._v("10")]),m("br"),m("span",{staticClass:"line-number"},[t._v("11")]),m("br"),m("span",{staticClass:"line-number"},[t._v("12")]),m("br")])]),m("h2",{attrs:{id:"_2-逻辑回归中的向量化"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#_2-逻辑回归中的向量化"}},[t._v("#")]),t._v(" 2. 逻辑回归中的向量化")]),t._v(" "),m("h3",{attrs:{id:"矩阵运算的相关基础"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#矩阵运算的相关基础"}},[t._v("#")]),t._v(" 矩阵运算的相关基础")]),t._v(" "),m("p",[t._v("矩阵乘法：")]),t._v(" "),m("h3",{attrs:{id:"变量的形状定义"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#变量的形状定义"}},[t._v("#")]),t._v(" 变量的形状定义")]),t._v(" "),m("ul",[m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"x"}})],1)],1)],1),t._v(" 表示特征数量，"),m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1),t._v(" 表示样本数量")],1),t._v(" "),m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-msub",[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"i"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"y"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"i"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1),t._v(" 表示一个单独的样本\n"),m("ul",[m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-msub",[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"i"}})],1)],1)],1)],1)],1),t._v(" 是一个 "),m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mn",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1),t._v(" 维特征向量")],1),t._v(" "),m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-msub",[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"y"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"i"}})],1)],1)],1)],1)],1),t._v(" 是一个标量，表示 0 或 1")],1)])],1),t._v(" "),m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"W"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"["}})],1),m("mjx-msub",[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"w"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"1"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"w"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"2"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"22EF"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"w"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"x"}})],1)],1)],1)],1),m("mjx-msup",[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"]"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"T"}})],1)],1)],1)],1)],1),t._v(" 表示参数 W，维度为 "),m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mn",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),t._v(" "),m("li",[t._v("b 表示偏置量，为一个实数")]),t._v(" "),m("li",[m("strong",[t._v("向量化")]),t._v(" "),m("ul",[m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"X"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"["}})],1),m("mjx-msub",[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"1"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"2"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"3"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"22EF"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"]"}})],1)],1)],1),t._v(" 表示样本矩阵，其维度为 "),m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),t._v(" "),m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Y"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"["}})],1),m("mjx-msub",[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"y"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"1"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"y"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"2"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"y"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"3"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"22EF"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-msub",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[m("mjx-c",{attrs:{c:"y"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"]"}})],1)],1)],1),t._v(" 表示标签矩阵，维度为 "),m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1)])])]),t._v(" "),m("h3",{attrs:{id:"前向传播"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#前向传播"}},[t._v("#")]),t._v(" 前向传播")]),t._v(" "),m("p",[t._v("所谓前向传播，即是通过样本特征和参数值计算预测值。")]),t._v(" "),m("p",[t._v("对于单个样本，计算公式为：")]),t._v(" "),m("p"),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-msup",[m("mjx-TeXAtom",[m("mjx-mover",[m("mjx-over",{staticStyle:{"padding-bottom":"0.06em","padding-left":"0.056em","margin-bottom":"-0.531em"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"^"}})],1)],1),m("mjx-base",{staticStyle:{"padding-left":"0.005em"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"y"}})],1)],1)],1)],1),m("mjx-script",{staticStyle:{"vertical-align":"0.492em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-msup",{attrs:{space:"4"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"W"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em","margin-left":"0.071em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"T"}})],1)],1)],1),m("mjx-msup",[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"+"}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"b"}})],1)],1)],1)],1),m("p"),t._v(" "),m("p",[t._v("为了得到所有训练样本的预测值，势必要使用 "),m("code",[t._v("for i in range(m)")]),t._v(" 的显式循环。使用向量化可以避免这一循环操作：")]),t._v(" "),m("p"),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-msup",{attrs:{space:"4"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"W"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em","margin-left":"0.071em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"T"}})],1)],1)],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"X"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"+"}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"b"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"p"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"."}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"o"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"t"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"W"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"."}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"T"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"X"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"+"}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"b"}})],1)],1)],1)],1),m("p"),t._v(" "),m("p",[t._v("其中，"),m("code",[t._v("W.shape = (nx, 1)")]),t._v("，"),m("code",[t._v("X.shape = (nx, m)")]),t._v("，"),m("code",[t._v("np.dot(W.T, X).shape = (1, m)")]),t._v("，向量与实数相加用到了 numpy 中的向量广播特性，最终得到的 "),m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1)],1)],1),t._v(" 形状为 "),m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1),t._v("。")],1),t._v(" "),m("p",[t._v("得到的向量 Z 通过 sigmoid 函数进行激活，得到最终结果：")]),t._v(" "),m("p"),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"A"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"3C3"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-TeXAtom",{attrs:{space:"4"}},[m("mjx-mfrac",[m("mjx-frac",{attrs:{type:"d"}},[m("mjx-num",[m("mjx-nstrut",{attrs:{type:"d"}}),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1),m("mjx-dbox",[m("mjx-dtable",[m("mjx-line",{attrs:{type:"d"}}),m("mjx-row",[m("mjx-den",[m("mjx-dstrut",{attrs:{type:"d"}}),m("mjx-mrow",[m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"+"}})],1),m("mjx-msup",{attrs:{space:"3"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"e"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"2212"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1),m("p"),t._v(" "),m("h3",{attrs:{id:"后向传播"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#后向传播"}},[t._v("#")]),t._v(" 后向传播")]),t._v(" "),m("p",[t._v("后向传播的目的是为了更新参数值。首先计算各参数相对于成本函数的偏导数，然后将其与学习率相乘，最后更新参数：")]),t._v(" "),m("p",[t._v("对于单个样本：")]),t._v(" "),m("p"),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-msup",[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"z"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-msup",{attrs:{space:"4"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"a"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2212"}})],1),m("mjx-msup",{attrs:{space:"3"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"y"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1)],1)],1)],1),m("p"),t._v(" "),m("p",[t._v("对于参数的更新：")]),t._v(" "),m("p"),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"w"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-TeXAtom",{attrs:{space:"4"}},[m("mjx-mfrac",[m("mjx-frac",{attrs:{type:"d"}},[m("mjx-num",[m("mjx-nstrut",{attrs:{type:"d"}}),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1),m("mjx-dbox",[m("mjx-dtable",[m("mjx-line",{attrs:{type:"d"}}),m("mjx-row",[m("mjx-den",[m("mjx-dstrut",{attrs:{type:"d"}}),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1)],1)],1)],1)],1)],1),m("mjx-munderover",{attrs:{space:"2"}},[m("mjx-over",{staticStyle:{"padding-bottom":"0.192em","padding-left":"0.412em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"m"}})],1)],1),m("mjx-box",[m("mjx-munder",[m("mjx-row",[m("mjx-base",[m("mjx-mo",{staticClass:"mjx-lop"},[m("mjx-c",{attrs:{c:"2211"}})],1)],1)],1),m("mjx-row",[m("mjx-under",{staticStyle:{"padding-top":"0.167em","padding-left":"0.148em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1)],1)],1),m("mjx-msup",{attrs:{space:"2"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"x"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-msup",[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"z"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1)],1)],1)],1),t._v(" "),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"b"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-TeXAtom",{attrs:{space:"4"}},[m("mjx-mfrac",[m("mjx-frac",{attrs:{type:"d"}},[m("mjx-num",[m("mjx-nstrut",{attrs:{type:"d"}}),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1),m("mjx-dbox",[m("mjx-dtable",[m("mjx-line",{attrs:{type:"d"}}),m("mjx-row",[m("mjx-den",[m("mjx-dstrut",{attrs:{type:"d"}}),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1)],1)],1)],1)],1)],1),m("mjx-munderover",{attrs:{space:"2"}},[m("mjx-over",{staticStyle:{"padding-bottom":"0.192em","padding-left":"0.412em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"m"}})],1)],1),m("mjx-box",[m("mjx-munder",[m("mjx-row",[m("mjx-base",[m("mjx-mo",{staticClass:"mjx-lop"},[m("mjx-c",{attrs:{c:"2211"}})],1)],1)],1),m("mjx-row",[m("mjx-under",{staticStyle:{"padding-top":"0.167em","padding-left":"0.148em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1)],1)],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-msup",[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"z"}})],1),m("mjx-script",{staticStyle:{"vertical-align":"0.413em"}},[m("mjx-TeXAtom",{attrs:{size:"s"}},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"i"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1)],1)],1)],1),t._v("\n向量化之后："),m("p"),t._v(" "),m("p"),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"A"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2212"}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"Y"}})],1)],1)],1)],1),t._v(" "),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"W"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-TeXAtom",{attrs:{space:"4"}},[m("mjx-mfrac",[m("mjx-frac",{attrs:{type:"d"}},[m("mjx-num",[m("mjx-nstrut",{attrs:{type:"d"}}),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1),m("mjx-dbox",[m("mjx-dtable",[m("mjx-line",{attrs:{type:"d"}}),m("mjx-row",[m("mjx-den",[m("mjx-dstrut",{attrs:{type:"d"}}),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1)],1)],1)],1)],1)],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"X"}})],1),m("mjx-msup",[m("mjx-TeXAtom",[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1)],1),m("mjx-script",{staticStyle:{"vertical-align":"0.421em"}},[m("mjx-mi",{staticClass:"mjx-i",attrs:{size:"s"}},[m("mjx-c",{attrs:{c:"T"}})],1)],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-TeXAtom",{attrs:{space:"4"}},[m("mjx-mfrac",[m("mjx-frac",{attrs:{type:"d"}},[m("mjx-num",[m("mjx-nstrut",{attrs:{type:"d"}}),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1),m("mjx-dbox",[m("mjx-dtable",[m("mjx-line",{attrs:{type:"d"}}),m("mjx-row",[m("mjx-den",[m("mjx-dstrut",{attrs:{type:"d"}}),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1)],1)],1)],1)],1)],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"p"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"."}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"o"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"t"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"X"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"."}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"T"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),t._v(" "),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"b"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"="}})],1),m("mjx-TeXAtom",{attrs:{space:"4"}},[m("mjx-mfrac",[m("mjx-frac",{attrs:{type:"d"}},[m("mjx-num",[m("mjx-nstrut",{attrs:{type:"d"}}),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1)],1),m("mjx-dbox",[m("mjx-dtable",[m("mjx-line",{attrs:{type:"d"}}),m("mjx-row",[m("mjx-den",[m("mjx-dstrut",{attrs:{type:"d"}}),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1)],1)],1)],1)],1)],1)],1)],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"p"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"."}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"s"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"u"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"Z"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),m("p"),t._v(" "),m("p",[t._v("参数更新：")]),t._v(" "),m("p"),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"W"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:":"}}),m("mjx-c",{attrs:{c:"="}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"W"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2212"}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"3B1"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"W"}})],1)],1)],1)],1),t._v(" "),m("p",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[m("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"b"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"2260"}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"b"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2212"}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"3B1"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"d"}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"b"}})],1)],1)],1)],1),m("p"),t._v(" "),m("h3",{attrs:{id:"迭代"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#迭代"}},[t._v("#")]),t._v(" 迭代")]),t._v(" "),m("p",[t._v("通过前向传播加后向传播的方式，我们完成了参数的一次更新，当然学习一次是远远不够用的。为了完成多次学习迭代，还是需要使用显式的 for 循环来实现：")]),t._v(" "),m("div",{staticClass:"language-python line-numbers-mode"},[m("pre",{pre:!0,attrs:{class:"language-python"}},[m("code",[m("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 初始化 W，b")]),t._v("\n\n"),m("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 假设学习 3000 次")]),t._v("\n"),m("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),m("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),m("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),m("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),m("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),m("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 前向传播")]),t._v("\n  "),m("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 后向传播")]),t._v("\n  "),m("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新参数")]),t._v("\n")])]),t._v(" "),m("div",{staticClass:"line-numbers-wrapper"},[m("span",{staticClass:"line-number"},[t._v("1")]),m("br"),m("span",{staticClass:"line-number"},[t._v("2")]),m("br"),m("span",{staticClass:"line-number"},[t._v("3")]),m("br"),m("span",{staticClass:"line-number"},[t._v("4")]),m("br"),m("span",{staticClass:"line-number"},[t._v("5")]),m("br"),m("span",{staticClass:"line-number"},[t._v("6")]),m("br"),m("span",{staticClass:"line-number"},[t._v("7")]),m("br")])]),m("h2",{attrs:{id:"向量的广播"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#向量的广播"}},[t._v("#")]),t._v(" 向量的广播")]),t._v(" "),m("p",[t._v("广播的原则：")]),t._v(" "),m("ul",[m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"B1"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2217"}})],1),m("mjx-TeXAtom",[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"/"}})],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mn",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"21D2"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),t._v(" "),m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"B1"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2217"}})],1),m("mjx-TeXAtom",[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"/"}})],1)],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mn",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"21D2"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mi",{staticClass:"mjx-i",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"n"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),t._v(" "),m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mn",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"B1"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2217"}})],1),m("mjx-TeXAtom",[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"/"}})],1)],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"R"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"21D2"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mn",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1),t._v(" "),m("li",[m("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[m("mjx-math",{staticClass:" MJX-TEX"},[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mn",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"B1"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[m("mjx-c",{attrs:{c:"2217"}})],1),m("mjx-TeXAtom",[m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:"/"}})],1)],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"R"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"21D2"}})],1),m("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[m("mjx-c",{attrs:{c:"("}})],1),m("mjx-mi",{staticClass:"mjx-i"},[m("mjx-c",{attrs:{c:"m"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:","}})],1),m("mjx-mn",{staticClass:"mjx-n",attrs:{space:"2"}},[m("mjx-c",{attrs:{c:"1"}})],1),m("mjx-mo",{staticClass:"mjx-n"},[m("mjx-c",{attrs:{c:")"}})],1)],1)],1)],1)]),t._v(" "),m("p",[m("img",{attrs:{src:a(526),alt:""}})]),t._v(" "),m("h3",{attrs:{id:"关于向量维度的一些最佳实践"}},[m("a",{staticClass:"header-anchor",attrs:{href:"#关于向量维度的一些最佳实践"}},[t._v("#")]),t._v(" 关于向量维度的一些最佳实践")]),t._v(" "),m("p",[t._v("由于广播机制，python 代码可能出现尽管运行成功，结果却在预期之外的情况。为了避免这些问题，有必要保持一些良好的习惯：")]),t._v(" "),m("ol",[m("li",[t._v("不要使用秩为 1 的向量")]),t._v(" "),m("li",[t._v("经常使用 np.reshape() 来确保向量形状符合需要")]),t._v(" "),m("li",[t._v("使用 assert(a.shape == (5, 1)) 来断言向量形状")])])])}),[],!1,null,null,null);s.default=c.exports}}]);